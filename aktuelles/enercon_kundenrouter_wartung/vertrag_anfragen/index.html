<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <title>Vertrag anfragen – Kevin Strakerjahn Networks & Automation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="../../../Logos/logo.png" />

  <style>
    :root{
      --bg:#f5f7fb;
      --card:#ffffff;
      --primary1:#2b7cff;
      --primary2:#7a5cff;
      --text:#1f2933;
      --muted:#6b7280;
      --shadow: 0 30px 80px rgba(0,0,0,.25);
      --radius:18px;
    }

    html, body{
      margin:0;
      padding:0;
      width:100%;
      height:100%;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;
      background: var(--bg);
      overflow:hidden; /* Wizard soll die ganze Fläche nutzen */
    }

    /* ===== App (blurred until consent) ===== */
    #app{
      position:fixed;
      inset:0;
      filter: blur(7px);
      pointer-events:none;
      transition: filter .25s ease;
    }

    /* ===== Steps wrapper ===== */
    #steps{
      position:fixed;
      inset:0;
      overflow:hidden;
      background: var(--bg);
    }

    .step{
      position:absolute;
      inset:0;
      background: var(--bg);
      transition: transform .35s ease;
      will-change: transform;
      transform: translateY(100%); /* default: unterhalb */
    }
    .step.active{ transform: translateY(0); }
    .step.from-bottom{ transform: translateY(100%); }
    .step.from-top{ transform: translateY(-100%); }

.step iframe{
      width:100%;
      height:100%;
      border:none;
      background: transparent;
      display:block;
    }

    /* ===== Consent Overlay ===== */
    #consent{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.35);
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:50;
    }

    #consentBox{
      background: var(--card);
      max-width: 560px;
      width: min(92vw, 560px);
      padding: 28px 28px 22px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      text-align:center; /* gewünscht: zentriert */
    }

    #consentBox h2{
      margin: 0 0 10px;
      font-size: 22px;
      color: var(--text);
      letter-spacing: .2px;
    }

    #consentBox p{
      margin: 0;
      color: var(--muted);
      line-height: 1.55;
      font-size: 15px;
    }

    #consentBox a{
      color: var(--primary1);
      text-decoration: none;
      font-weight: 700;
    }
    #consentBox a:hover{ text-decoration: underline; }

    #consentBox .hint{
      margin-top: 14px;
      font-size: 13px;
      color: #8a93a3;
    }

    #consentBox button{
      margin-top: 18px;
      width: 100%;
      padding: 14px 16px;
      border: none;
      border-radius: 999px;
      font-size: 16px;
      font-weight: 700;
      color: #fff;
      background: linear-gradient(135deg,var(--primary1),var(--primary2));
      cursor: pointer;
      transition: transform .15s ease, filter .15s ease;
    }
    #consentBox button:hover{
      transform: translateY(-1px);
      filter: brightness(1.03);
    }
    #consentBox button:active{
      transform: translateY(0);
      filter: brightness(.98);
    }
  </style>
</head>

<body>
  <!-- ===== Consent Overlay ===== -->
  <div id="consent" aria-modal="true" role="dialog">
    <div id="consentBox">
      <h2>Hinweis Datenschutz &amp; AGB</h2>
      <p>
        Für die Vertragsanfrage ist die Zustimmung zur
        <a href="../../../datenschutz/" target="_blank" rel="noopener">Datenschutzerklärung</a>
        und zu den
        <a href="../../../agb/" target="_blank" rel="noopener">AGB</a>
        erforderlich.
      </p>
      <div class="hint">Bitte bestätigen, um fortzufahren.</div>
      <button type="button" onclick="acceptConsent()">Zustimmen &amp; fortfahren</button>
    </div>
  </div>

  <!-- ===== App (blurred until consent) ===== -->
  <div id="app">
    <div id="steps">
      <div class="step active" id="step1">
        <iframe src="steps/step1_rechnung_pruefen.html" title="Step 1 – Rechnung prüfen"></iframe>
      </div>
      <div class="step" id="step2">
        <iframe src="steps/step2_daten_pruefen.html" title="Step 2 – Daten prüfen"></iframe>
      </div>
      <div class="step" id="step3">
        <iframe src="steps/step3_person_bestaetigen.html" title="Step 3 – Person bestätigen"></iframe>
      </div>
      <div class="step" id="step4">
        <iframe src="steps/step4_paket_waehlen.html" title="Step 4 – Paket wählen"></iframe>
      </div>
      <div class="step" id="step5">
        <iframe src="steps/step5_vertrag_bestaetigen.html" title="Step 5 – Vertrag bestätigen"></iframe>
      </div>
    </div>
  </div>

  <script>
    let currentStep = 1;
    const totalSteps = 5;

    function acceptConsent(){
      document.getElementById('consent').style.display = 'none';

      const app = document.getElementById('app');
      app.style.filter = 'none';
      app.style.pointerEvents = 'auto';
    }

    function clamp(n){
      return Math.max(1, Math.min(totalSteps, Number(n)));
    }

    function showStep(next, direction){
      next = clamp(next);
      if (next === currentStep) return;

      const current = document.getElementById('step' + currentStep);
      const target  = document.getElementById('step' + next);

      // --- Reset target to a clean state
      target.classList.remove('active', 'from-top', 'from-bottom');

      // --- Pre-position target (so animation starts correctly)
      if (direction === 'backward') {
        target.classList.add('from-top');     // start above
      } else {
        target.classList.add('from-bottom');  // start below
      }

      // Force reflow so browser registers start position before we animate to active
      void target.offsetHeight;

      // Ensure current is active, then start transition:
      // current leaves opposite direction, target moves to center
      current.classList.remove('from-top', 'from-bottom');
      if (direction === 'backward') {
        current.classList.add('from-bottom'); // current goes down
      } else {
        current.classList.add('from-top');    // current goes up
      }
      current.classList.remove('active');

      // target enters
      target.classList.add('active');
      target.classList.remove('from-top', 'from-bottom');

      // cleanup leaving classes after animation
      window.setTimeout(() => {
        current.classList.remove('from-top', 'from-bottom');
      }, 380);

      currentStep = next;
    }

    // ===== API für die Step-HTMLs =====
    window.nextStep = function(){
      if (currentStep < totalSteps) showStep(currentStep + 1, 'forward');
    };

    window.prevStep = function(){
      if (currentStep > 1) showStep(currentStep - 1, 'backward');
    };

    window.goToStep = function(n){
      n = clamp(n);
      if (n > currentStep) showStep(n, 'forward');
      else if (n < currentStep) showStep(n, 'backward');
    };
  </script>
</body>
</html>
